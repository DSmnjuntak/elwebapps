<!DOCTYPE html>
<html>
    <head>
        <title>With JS</title>
        <script src="azure-storage-blob.js" charset="utf-8"></script>
    </head>
    <body>
        <script type="text/javascript">
            const browseButton = document.getElementById("images");
            const uploadButton = document.getElementById("uploadbtn");

            function uploadImage(){

                const accountName = "elblob";
                const sasString = "DefaultEndpointsProtocol=https;AccountName=elblob;AccountKey=eYN/5ydmra64pH2n/CidhThUPSU9a1MuKe18qyEQJ+/jPsOzCZwzWkUBs0calUtYo6fL5ginPCgks6lmrZtltA==;EndpointSuffix=core.windows.net";
                const containerName = "images";
                const containerURL = new azblob.ContainerURL(
                    `https://${accountName}.blob.core.windows.net/${containerName}?${sasString}`,
                    azblob.StorageURL.newPipeline(new azblob.AnonymousCredential));
                if (browseButton.value){
                    try {
                        reportStatus(`Creating container "${containerName}"...`);
                        await containerURL.create(azblob.Aborter.none);
                        reportStatus(`Done.`);
                    } catch (error) {
                        reportStatus(error.body.message);
                    }
                    try {
                        reportStatus("Uploading files...");
                        const promises = [];
                        for (const file of uploadImage.files) {
                            const blockBlobURL = azblob.BlockBlobURL.fromContainerURL(containerURL, file.name);
                            promises.push(azblob.uploadBrowserDataToBlockBlob(
                                azblob.Aborter.none, file, blockBlobURL));
                        }
                        await Promise.all(promises);
                        reportStatus("Done.");
                        listFiles();
                    } catch (error) {
                        reportStatus(error.body.message);
                    }
                }
                else {
                    alert("failed Upload");
                }
                
                    
            }
            
        </script>
        <h1>Analyze image:</h1>
        Enter the URL to an image, then click the <strong>Analyze image</strong> button.
        <br><br>
        <!-- <input type="text" name="inputImage" id="inputImage"
            value="https://elblob.blob.core.windows.net/images/DSC_0131.JPG" /> -->
        <input type="file" id="images"/>
        <button type="button" id="uploadbtn">Upload image</button>
        <button type="button" onclick="processImage()">Analyze image</button>
        <span id="custom-text">No File Choosen, yet.</span>
        <br><br>
        <div id="wrapper" style="width:1020px; display:table;">
            <div id="jsonOutput" style="width:600px; display:table-cell;">
                Response:
                <br><br>
                <textarea id="responseTextArea" class="UIInput"
                        style="width:580px; height:400px;"></textarea>
            </div>
            <div id="imageDiv" style="width:420px; display:table-cell;">
                Source image:
                <br><br>
                <img id="sourceImage" width="400" />
            </div>
        </div>
    </body>
    <!-- You'll add code here later in this quickstart. -->
    
</html>